---
title: "Megafauna-genetics"
author: "Pedro Jordano"
date: "marzo 13, 2015"
output: html_document
---

Analysis of genetic differentiation for megafauna-dependent species.    

Combining Duminil et al. 2007 and our own compiliation for brazilian species.
Duminil, J., S. Fineschi, A. Hampe, P. Jordano, D. Salvini, G. G. Vendramin, and R. J. Petit. 2007. Can population genetic structure be predicted from life-history traits? _The American Naturalist_ 169:662â€“672.   

We now use Rosanne Collevatti's dataset, updated August 2014, with many more brazilian species.

#### Data input

We have two datasets. The `gst` dataset comes from our own data (Duminil et al 2007) and the compiled data we had since the first megafauna paper.   

The second dataset is the one we are using, based on Rosanne's dataset, thoroughly checked and recoded.   


```{r data, eval=TRUE, message=FALSE}
# Data input.
# NOTE: gst as for 3Mar mixes Gst and Fst data and different nuclear markers (SSR, isozymes, etc.).

require(dplyr)
gst <-read.table("./datasets/gst.txt", header=TRUE, sep="\t", dec=".", 
                 na.strings="NA")

str(gst)
rosanne <-read.table("./datasets/rosanne.txt", header=TRUE, sep="\t", 
                     dec=".", na.strings="NA")
str(rosanne)
names (rosanne)

```

#### Codes for disperser groups
```{r tables, eval=TRUE, message=FALSE}
# Tables for group categories.
table(rosanne$dispcode)     #1    
table(rosanne$dispersal)    #2
table(rosanne$anacron)      #3
table(rosanne$contr_mf)     #4

```

#### Testing differences among groups. $F_{st}$

```{r tests, eval=TRUE, message=FALSE}
# Megafauna-dependent vs megafauna independent vs non-megafauna.
m1<- lm(asin(rosanne$FST)~ rosanne$dispcode)
summary(m1)

# Megafauna-dependent vs megafauna independent vs non-megafauna.
m2<- lm(asin(rosanne$FST)~ rosanne$anacron)
summary(m2)

# Magafauna-dependent vs megafauna independent vs other syndromes.
m3<- lm(asin(rosanne$FST)~ rosanne$contr_mf)
summary(m3)

```

#### Box plots - Rosanne's Dataset

```{r boxplots1, eval=TRUE, message=FALSE, fig.width=5}
p1 <- ggplot(rosanne, aes(factor(dispcode), FST, na.rm = TRUE))
p1 + geom_boxplot() +
    xlab("Seed dispersal syndrome") +
    ylab("Population genetic differentiation, Fst")

#-------------
p2 <- ggplot(rosanne, aes(factor(anacron), FST, fill=factor(anacron))) +
    #    stat_boxplot(geom ='errorbar')+
    geom_boxplot()+
    scale_fill_manual(name= "Syndrome", 
        values=c("burlywood","lightblue","blue"), 
        labels = c("md"= "Megafauna dependent", 
                   "mi"= "Megafauna independent",
                   "n"="Other")) +
    xlab("Seed dispersal syndrome") +
    ylab("Population genetic differentiation, Fst")
p2
#-------------
p3 <- ggplot(rosanne, aes(factor(contr_mf), FST, na.rm = TRUE))
p3 + geom_boxplot() +
    xlab("Seed dispersal syndrome") +
    ylab("Population genetic differentiation, Fst")

```

#### Tests and box plots on grouped data- Rosanne's Dataset

```{r boxplots2, eval=TRUE, message=FALSE, fig.width=5}

```



# Megafauna dependent, megafauna independent, extant frugivores
ppz<- rosanne %.% 
      filter(anacron=="md" |anacron=="mi") %.%
      select(anacron, FST)
m3<- lm(asin(ppz$FST)~ ppz$anacron)
summary(m3)
anova(m3)

# Box plots
p <- ggplot(ppz, aes(factor(anacron), FST))
p + geom_boxplot()

p <- ggplot(ppz[ppz$anacron!="NA",], 
    aes(factor(anacron), FST, fill=factor(anacron)))
p + geom_boxplot() +
    scale_fill_manual(name= "Syndrome", 
        values=c("blue","lightblue")) +
    xlab("Seed dispersal syndrome") +
    ylab("Population genetic differentiation, Fst")

# Just the zoochoric taxa
He<- rosanne %.%
     filter(anacron=="md" | anacron=="mi") %.%
     select(anacron, He)

m4<- lm(asin(He$He)~ He$anacron)
summary(m4)
anova(m4)

# Zoochoric comparison.





